<source>
  type forward
  port 24224
</source>

# forwarding to bigquery plugin
<match aggre_mod.*>
  type bigquery

  auth_method private_key
  email "#{ENV['GCP_SERVICE_ACCOUNT_EMAIL']}"
  private_key_path /fluentd/etc/private_key.p12
  private_key_passphrase notasecret

  project "#{ENV['GCP_PROJECT']}"
  dataset "#{ENV['GCP_BIGQUERY_DATASET']}"
  tables "#{ENV['GCP_BIGQUERY_TABLE']}"

  field_string  name
  field_float   temp,humidity,windspeed,winddirection,rainfall
  time_field    timestamp
  fetch_schema true
</match>
